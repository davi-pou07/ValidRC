<!DOCTYPE html>
<html lang="pt-Br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email CRM</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/dataTables.Botstrap5.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</head>

<body onload="button()">
    <div class="container mt-3">
        <h3>Adicione a planilha abaixo para validação</h3>
        <hr>
        <p>Planilha deve esta nos formatos (.xlsx, .csv, .xls...) </p>
        <form action="/exportar" method="post" enctype="multipart/form-data">
            <input class="form-control" onchange="validar(this.value)" type="file" id="arquivo" name="arquivo">
            <button class="btn btn-primary text-white mt-2" id="buttom" disabled type="submit">VALIDAR</button>
        </form>
        <div class="card mt-5">
            <div class="card-header bg-primary text-white">
                <h4>Exemplos padrões que devem estar o arquivo</h4>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome/Razão</th>
                                <th>CGC</th>
                                <th>EMAIL</th>
                                <th>Telefone 1</th>
                                <th>Telefone 2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>João Pedro</td>
                                <td>000.000.000-99</td>
                                <td>joao0099@gmail.com</td>
                                <td>86999999999</td>
                                <td>8632333465</td> 
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Lucas Henrique</td>
                                <td>000.000.000-10</td>
                                <td>licas0010@gmail.com</td>
                                <td>86988888888</td>
                                <td>8632333466</td> 
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>Mateus Santos</td>
                                <td>000.000.000-50</td>
                                <td>mateus0050@gmail.com</td>
                                <td>86999888888</td>
                                <td>8632333425</td> 
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer">
                <p>O arquivo deve estar em uma das duas sequencias acima, caso contrario a validação não será sucedida.</p>
            </div>
        </div>
        <script>
            function validar(valor) {
                if (valor.includes('.xlsx') || valor.includes('.xlsm') || valor.includes('.xlsb') || valor.includes('.xltx') || valor.includes('.xltm') || valor.includes('.xls') || valor.includes('.xlt') || valor.includes('.xls') || valor.includes(".csv") || valor.includes(".csv")) {
                    document.getElementById("buttom").disabled = false
                } else {
                    alert("Arquivo não está no formato correto!!")
                    document.getElementById("buttom").disabled = true
                }
            }
        </script>
</body>

</html>